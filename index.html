<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inked by Chris - Tattoo Artist</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon.svg">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            emailjs.init({
                publicKey: "nqLDVniO3BUlQ-e1n"
            });
        })();
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    
    <!-- Add Twilio library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twilio/4.7.2/twilio.min.js"></script>
</head>
<body>
    <div class="cursor"></div>
    <header>
        <nav class="navbar">
            <div class="logo">Inked by Chris</div>
            <div class="nav-content">
                <div class="payment-methods-header">
                    <div class="payment-method" title="Cash">
                        <i class="fa-solid fa-money-bills"></i>
                        <span class="payment-label">Cash</span>
                    </div>
                    <div class="payment-method" title="Zelle">
                        <i class="fa-solid fa-circle-dollar-to-slot"></i>
                        <span class="payment-label">Zelle</span>
                    </div>
                    <div class="payment-method" title="PayPal">
                        <i class="fa-brands fa-paypal"></i>
                        <span class="payment-label">PayPal</span>
                    </div>
                </div>
                <ul class="nav-links">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#gallery">Gallery</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#book">Book</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <section id="home" class="hero">
            <div class="hero-overlay"></div>
            <div class="ink-bg"></div>
            <div class="container">
                <div class="hero-content">
                    <div class="pen-icon">
                        <i class="fas fa-pen-fancy"></i>
                    </div>
                    <h1 class="hero-title">INKED BY CHRIS</h1>
                    <p class="hero-subtitle">CRAFTING YOUR VISION</p>
                    <div class="hero-description">
                        <p>Custom Designs | Artistic Excellence | Timeless Ink</p>
                    </div>
                    <div class="hero-cta">
                        <a href="#book" class="cta-button">
                            <span>START YOUR JOURNEY</span>
                            <i class="fas fa-pen-nib"></i>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section id="about" class="about">
            <div class="container">
                <h2>The Artist</h2>
                <div class="artist-profile">
                    <div class="artist-image">
                        <img src="./images/chris-profile.jpg" alt="Chris Mod - Professional Tattoo Artist" class="profile-img">
                    </div>
                    <div class="artist-bio">
                        <h3>Chris Mod</h3>
                        <p>I'm Chris Mod, a passionate and highly skilled tattoo artist with a true love for the craft. My journey into the world of tattoos began years ago, and it's been an incredible experience ever since. I've dedicated myself to mastering the art of tattooing, ensuring that each piece I create is not just a tattoo, but a work of art that reflects my client's personality, vision, and individuality.</p>
                        <div class="specialties">
                            <h4>Specialties</h4>
                            <ul>
                                <li><i class="fas fa-star"></i> Custom Designs</li>
                                <li><i class="fas fa-star"></i> Black & Grey</li>
                                <li><i class="fas fa-star"></i> Color Realism</li>
                                <li><i class="fas fa-star"></i> Neo-Traditional</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="gallery" class="gallery">
            <div class="container">
                <h2>My Work</h2>
                <div class="gallery-grid">
                    <div class="gallery-item">
                        <img src="./images/IMG_6827.jpg" alt="Custom tattoo design showcasing detailed artistry" loading="lazy">
                        <div class="gallery-overlay">
                            <p>Custom Design</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="./images/IMG_6845.jpg" alt="Intricate tattoo artwork with fine details" loading="lazy">
                        <div class="gallery-overlay">
                            <p>Fine Detail Work</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="./images/IMG_6860 (1).jpg" alt="Unique tattoo design with personal meaning" loading="lazy">
                        <div class="gallery-overlay">
                            <p>Personal Design</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="./images/IMG_6970.jpg" alt="Beautiful custom tattoo artwork" loading="lazy">
                        <div class="gallery-overlay">
                            <p>Custom Artwork</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="./images/IMG_6974.jpg" alt="Stunning tattoo design showcasing artistic skill" loading="lazy">
                        <div class="gallery-overlay">
                            <p>Artistic Design</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="contact-section">
            <div class="contact-container">
                <h2 class="section-title">Get in Touch</h2>
                <div class="contact-content">
                    <div class="contact-info">
                        <div class="contact-card phone">
                            <div class="icon-wrapper">
                                <i class="fas fa-phone-alt"></i>
                            </div>
                            <div class="info-content">
                                <h3>Call Us</h3>
                                <a href="tel:+16515925122" class="contact-link" data-action="Tap to call">
                                    <i class="fas fa-phone-alt contact-icon"></i>
                                    (651) 592-5122
                                </a>
                            </div>
                        </div>
                        <div class="contact-card address">
                            <div class="icon-wrapper">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="info-content">
                                <h3>Visit Us</h3>
                                <a href="https://maps.google.com/?q=2395+7th+St+N,+Saint+Paul,+MN+55109" target="_blank" class="contact-link" data-action="Open in Google Maps">
                                    <i class="fas fa-map-marker-alt contact-icon"></i>
                                    2395 7th St N<br>
                                    Saint Paul, MN 55109
                                </a>
                            </div>
                        </div>
                        <div class="contact-card email">
                            <div class="icon-wrapper">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="info-content">
                                <h3>Email Us</h3>
                                <a href="mailto:senghakmad@gmail.com" class="contact-link" data-action="Open email client">
                                    <i class="fas fa-envelope contact-icon"></i>
                                    senghakmad@gmail.com
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="social-links">
                        <a href="https://instagram.com/inked_bychris" class="social-link instagram" target="_blank">
                            <i class="fab fa-instagram"></i>
                            <span>Follow on Instagram</span>
                            <small>@inked_bychris</small>
                        </a>
                        <a href="https://snapchat.com/add/sasuke_2k" class="social-link snapchat" target="_blank">
                            <i class="fab fa-snapchat-ghost"></i>
                            <span>Add on Snapchat</span>
                            <small>@sasuke_2k</small>
                        </a>
                    </div>
                </div>
            </div>
            <div class="contact-background"></div>
        </section>

        <section id="book" class="booking">
            <div class="container">
                <h2>Book a Consultation</h2>
                <form id="bookingForm" class="booking-form">
                    <div class="form-section">
                        <h3>Personal Information</h3>
                        <div class="form-group">
                            <input type="text" id="client_name" name="client_name" placeholder="Full Name" required>
                        </div>
                        <div class="form-group">
                            <input type="email" id="client_email" name="client_email" placeholder="Email Address" required>
                        </div>
                        <div class="form-group">
                            <input type="tel" id="client_phone" name="client_phone" placeholder="Phone Number (xxx-xxx-xxxx)" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" maxlength="12" required>
                        </div>
                        <div class="form-group">
                            <select id="client_gender" name="client_gender" required>
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                                <option value="prefer_not_to_say">Prefer not to say</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="date" id="client_birthdate" name="client_birthdate" required>
                            <label for="client_birthdate" class="date-label">Date of Birth (Must be 18 or older)</label>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Preferred Appointment</h3>
                        <div class="form-group">
                            <input type="text" id="datePicker" name="preferred_date" placeholder="Select Date" required readonly>
                            <div class="input-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                        </div>
                        <div class="form-group">
                            <select name="preferred_time" id="timeSlot" required>
                                <option value="">Select Time</option>
                                <option value="10:00 AM">10:00 AM</option>
                                <option value="11:00 AM">11:00 AM</option>
                                <option value="12:00 PM">12:00 PM</option>
                                <option value="1:00 PM">1:00 PM</option>
                                <option value="2:00 PM">2:00 PM</option>
                                <option value="3:00 PM">3:00 PM</option>
                                <option value="4:00 PM">4:00 PM</option>
                                <option value="5:00 PM">5:00 PM</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Tattoo Details</h3>
                        <div class="form-group">
                            <select name="tattooType" id="tattooType" required>
                                <option value="">Select Tattoo Type</option>
                                <option value="Custom Design">Custom Design</option>
                                <option value="Black & Grey">Black & Grey</option>
                                <option value="Color Realism">Color Realism</option>
                                <option value="Neo-Traditional">Neo-Traditional</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <select name="tattooSize" id="tattooSize" required>
                                <option value="">Select Tattoo Size</option>
                                <option value="Small">Small</option>
                                <option value="Medium">Medium</option>
                                <option value="Large">Large</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <select name="tattooPlacement" id="tattooPlacement" required>
                                <option value="">Select Placement</option>
                                <option value="Arm">Arm</option>
                                <option value="Leg">Leg</option>
                                <option value="Back">Back</option>
                                <option value="Chest">Chest</option>
                                <option value="Shoulder">Shoulder</option>
                                <option value="Ankle">Ankle</option>
                                <option value="Wrist">Wrist</option>
                                <option value="Other">Other (specify in description)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <select name="colorPreference" id="colorPreference">
                                <option value="">Select Color Preference</option>
                                <option value="Black and Grey">Black and Grey</option>
                                <option value="Full Color">Full Color</option>
                                <option value="Black Work">Black Work</option>
                                <option value="Not Sure">Not Sure (Will discuss)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <textarea id="tattooDescription" name="tattooDescription" placeholder="Describe your tattoo idea in detail" required></textarea>
                        </div>
                        <div class="form-group">
                            <textarea name="additionalNotes" id="additionalNotes" placeholder="Any additional notes or special requests?"></textarea>
                        </div>
                    </div>

                    <div class="form-section policy-section">
                        <h3>Cancellation Policy</h3>
                        <div class="policy-text">
                            <p>Please read our cancellation policy carefully:</p>
                            <ul>
                                <li>A 24-hour notice is required for all cancellations.</li>
                                <li>To cancel your appointment, use the cancellation link provided in your confirmation email.</li>
                                <li>For questions or rescheduling, contact us at senghakmad@gmail.com or call/text (651) 592-5122.</li>
                                <li>We appreciate your courtesy in notifying us of any changes to your appointment.</li>
                            </ul>
                        </div>
                        <div class="form-group policy-agreement">
                            <input type="checkbox" name="policy_agreement" id="policy_agreement" required>
                            <label for="policy_agreement">I understand and agree to the cancellation policy</label>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn">Request Consultation</button>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-links">
                <a href="privacy.html">Privacy Policy</a>
                <a href="terms.html">Terms & Conditions</a>
            </div>
            <p>&copy; 2025 Inked by Chris. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Initialize EmailJS
        (function() {
            emailjs.init("nqLDVniO3BUlQ-e1n");
        })();

        // Generate a unique booking ID
        function generateBookingId() {
            return 'BK' + Date.now().toString(36) + Math.random().toString(36).substr(2, 5);
        }

        // Age verification function
        function isOver18(birthDate) {
            const today = new Date();
            const birth = new Date(birthDate);
            let age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                age--;
            }
            
            return age >= 18;
        }

        // Format date for display
        const formatDate = (dateStr) => {
            return new Date(dateStr).toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        };

        // Format gender for display
        const formatGender = (gender) => {
            const genderMap = {
                'male': 'Male',
                'female': 'Female',
                'other': 'Other',
                'prefer_not_to_say': 'Prefer not to say'
            };
            return genderMap[gender] || gender;
        };

        // Twilio configuration
        const TWILIO_ACCOUNT_SID = 'YOUR_ACCOUNT_SID'; // You'll need to replace this
        const TWILIO_AUTH_TOKEN = 'YOUR_AUTH_TOKEN';   // You'll need to replace this
        const TWILIO_PHONE_NUMBER = 'YOUR_TWILIO_NUMBER'; // You'll need to replace this

        // Function to format phone number
        function formatPhoneNumber(phone) {
            // Remove all non-numeric characters
            const cleaned = phone.replace(/\D/g, ''); // Remove all non-digits
            if (cleaned.length >= 3 && cleaned.length < 6) {
                value = cleaned.slice(0,3) + '-' + cleaned.slice(3);
            } else if (cleaned.length >= 6) {
                value = cleaned.slice(0,3) + '-' + cleaned.slice(3,6) + '-' + cleaned.slice(6,10);
            }
            return value;
        }

        // Function to send SMS
        async function sendSMS(to, message) {
            try {
                const response = await fetch('https://api.twilio.com/2010-04-01/Accounts/' + TWILIO_ACCOUNT_SID + '/Messages.json', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Authorization': 'Basic ' + btoa(TWILIO_ACCOUNT_SID + ':' + TWILIO_AUTH_TOKEN)
                    },
                    body: new URLSearchParams({
                        'To': formatPhoneNumber(to),
                        'From': TWILIO_PHONE_NUMBER,
                        'Body': message
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to send SMS');
                }
                
                return await response.json();
            } catch (error) {
                console.error('Error sending SMS:', error);
                throw error;
            }
        }

        // Handle booking form submission
        document.getElementById('bookingForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.textContent;
            submitBtn.textContent = 'Sending Request...';
            submitBtn.disabled = true;

            try {
                // Age verification
                const birthDate = document.getElementById('client_birthdate').value;
                if (!isOver18(birthDate)) {
                    alert('Sorry, you must be 18 or older to book an appointment.');
                    return;
                }

                // Generate booking ID and cancellation URL with all details
                const bookingId = generateBookingId();
                const cancelUrl = `${window.location.origin}${window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'))}/cancel.html?` + 
                    `id=${bookingId}&` +
                    `email=${encodeURIComponent(document.getElementById('client_email').value)}&` +
                    `name=${encodeURIComponent(document.getElementById('client_name').value)}&` +
                    `date=${encodeURIComponent(formatDate(document.getElementById('datePicker').value))}&` +
                    `time=${encodeURIComponent(document.getElementById('timeSlot').value)}&` +
                    `type=${encodeURIComponent(document.getElementById('tattooType').value)}&` +
                    `size=${encodeURIComponent(document.getElementById('tattooSize').value)}&` +
                    `placement=${encodeURIComponent(document.getElementById('tattooPlacement').value)}&` +
                    `phone=${encodeURIComponent(document.getElementById('client_phone').value)}`;

                // Calculate client's age
                const clientAge = isOver18(birthDate) ? Math.floor((new Date() - new Date(birthDate)) / (365.25 * 24 * 60 * 60 * 1000)) : 'Under 18';

                // Get form values
                const clientName = document.getElementById('client_name').value;
                const clientEmail = document.getElementById('client_email').value;
                const clientPhone = document.getElementById('client_phone').value;
                const clientGender = document.getElementById('client_gender').value;
                const preferredDate = document.getElementById('datePicker').value;
                const preferredTime = document.getElementById('timeSlot').value;
                const tattooType = document.getElementById('tattooType').value;
                const tattooSize = document.getElementById('tattooSize').value;
                const tattooPlacement = document.getElementById('tattooPlacement').value;
                const colorPreference = document.getElementById('colorPreference').value;
                const tattooDescription = document.getElementById('tattooDescription').value;
                const additionalNotes = document.getElementById('additionalNotes').value || 'None provided';

                // Send email and SMS notifications
                try {
                    // Send confirmation email to client
                    await emailjs.send('service_3pilkcs', 'template_gowinjb', {
                        to_name: clientName,
                        from_name: "Inked by Chris",
                        to_email: clientEmail,
                        reply_to: "senghakmad@gmail.com",
                        booking_id: bookingId,
                        booking_date: formatDate(preferredDate),
                        booking_time: preferredTime,
                        tattoo_type: tattooType,
                        tattoo_size: tattooSize,
                        tattoo_placement: tattooPlacement,
                        cancel_url: cancelUrl
                    });

                    // Send SMS confirmation
                    const appointmentSMS = `
Appointment Confirmed!
Date: ${formatDate(preferredDate)}
Time: ${preferredTime}
Type: ${tattooType}
Size: ${tattooSize}

Need to cancel? Visit:
${cancelUrl}

Questions? Call or text: (555) 555-5555`;

                    await sendSMS(clientPhone, appointmentSMS);
                    
                    // Show success message and reset form
                    alert('Booking request sent successfully! Please check your email and phone for confirmation.');
                    this.reset();
                    window.location.href = '#home';
                } catch (error) {
                    console.error('Error sending notifications:', error);
                    alert('Your appointment was saved but there was an error sending notifications. Please contact us for confirmation.');
                }
            } catch (error) {
                console.error('Failed to send email:', error);
                const errorMessage = error.text || error.message || 'Unknown error';
                alert(`Sorry, there was an error sending your booking request: ${errorMessage}\nPlease try again or contact us directly at 651-592-5122.`);
            } finally {
                // Reset button state
                submitBtn.textContent = originalBtnText;
                submitBtn.disabled = false;
            }
        });
    </script>

    <script>
        // Initialize Flatpickr
        const datePicker = flatpickr("#datePicker", {
            minDate: "today",
            dateFormat: "Y-m-d",
            disable: [
                function(date) {
                    // Disable Sundays and Mondays
                    return (date.getDay() === 0 || date.getDay() === 1);
                }
            ],
            locale: {
                firstDayOfWeek: 1 // Start week on Monday
            },
            disableMobile: false, // Enable custom calendar on mobile
            static: true,
            theme: "dark"
        });
    </script>

    <script>
        // Add phone number formatting
        document.getElementById('client_phone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, ''); // Remove all non-digits
            if (value.length >= 3 && value.length < 6) {
                value = value.slice(0,3) + '-' + value.slice(3);
            } else if (value.length >= 6) {
                value = value.slice(0,3) + '-' + value.slice(3,6) + '-' + value.slice(6,10);
            }
            e.target.value = value;
        });
    </script>

    <script src="script.js"></script>
    <script src="booking.js"></script>
</body>
</html>
